10  COM R1,T$[13]
20  COM A[6,150],D[6,100],E[205],F[35],G[2,12]
30  COM H[20,6],I[35],J[3,6],A$[10],B$[10],C$[255]
40  COM D1,L1,L2,L3,L4,L5,L6,L7,L8,L9,M1,M2,M3,M4,M5,M6,M7,M8,M9
50  COM N1,N2,N3,N4,N5,N6
60  COM Q1,Q2,Q3,Q4,Q5,Q6,Q7,Q8,R9
65  COM X,P1,O0
70  FILES *ADV001,*,*
80  REM * ADVENTURE *
90  REM * VERB PROCESSOR (PART 1)
100  REM
110  REM
120  REM
130  REM
140  REM
150  IF T$="**" THEN 200
160  PRINT "THIS PROGRAM IS PART OF ADVENTURE."
170  PRINT "TO RUN TYPE:"
180  PRINT "EXE-*ADVENT"
190  STOP 
200  CHAIN "*ADVP00",200
210  CHAIN "*ADVP10",210
220  CHAIN "*ADVP01",220
230  CHAIN "*ADVP10",230
240  CHAIN "*ADVP10",240
250  CHAIN "*ADVP10",250
260  CHAIN "*ADVP10",260
270  CHAIN "*ADVP01",270
280  CHAIN "*ADVP01",280
290  CHAIN "*ADVP01",290
300  CHAIN "*ADVP03",300
310  CHAIN "*ADVP03",310
320  CHAIN "*ADVP03",320
330  CHAIN "*ADVP03",330
340  CHAIN "*ADVP10",340
350  CHAIN "*ADVP10",350
360  CHAIN "*ADVP99",360
366  CHAIN "*ADVVOC",200
370  GOTO 2660
560  GOTO Q7-16 OF 580,1610,580,1780,580,2300,2550,2640,2760,2990,3030,580,580,580
570  GOTO Q7-16 OF 1000,7000,1670,1670,1920,2300,2550,7000,7000,7000,3120,3290,3440,3480
580  CHAIN "*ADVP99",580
590  GOTO 2300
600  CHAIN "*ADVP88",600
610  CHAIN "*ADVP99",610
620  CHAIN "*ADVP98",620
630  CHAIN "*ADVP99",630
640  GOTO 3670
1000  IF D[1,6]#-1 OR Q2#5 OR D[1,5]=-1 THEN 1020
1010  Q2=6
1020  IF D[1,Q2]#-1 THEN 7000
1030  IF Q2 >= 50 AND Q2 <= 79 AND (D[1,33]=L1 OR D[2,33]=L1) THEN 1420
1040  IF Q2=19 AND (D[1,35]=L1 OR D[1,35]=-1) THEN 1400
1050  IF Q2#28 THEN 610
1060  FOR X=1 TO 5
1070  IF J[2,X]=L1 THEN 1160
1080  NEXT X
1090  R9=152
1100  IF (D[1,31]=L1 OR D[2,31]=L1) AND D[4,31]=0 THEN 1240
1110  R9=158
1120  IF D[1,33]=L1 OR D[2,33]=L1 THEN 1240
1130  IF (D[1,35]=L1 OR D[1,35]=-1) AND D[4,35]=0 THEN 1310
1140  Q2=0
1150  GOTO 620
1160  R9=48
1170  IF RND(0)<.3 THEN 1240
1180  J[3,X]=0
1190  J[2,X]=0
1200  R9=47
1210  M9=M9+1
1220  IF M9#1 THEN 1240
1230  R9=149
1240  P1=R9
1250  GOSUB 8000
1260  P1=28
1270  P2=L1
1280  GOSUB 9200
1290  Q8=21
1300  GOTO 270
1310  R9=164
1320  P1=28
1330  P2=L1
1340  GOSUB 9200
1350  D[2,28]=-1
1360  D[4,28]=1
1370  P1=35
1380  GOSUB 8800
1390  GOTO 7000
1400  Q2=35
1410  GOTO 1920
1420  R9=159
1430  P1=Q2
1440  P2=0
1450  GOSUB 9200
1460  P1=33
1470  P2=0
1480  GOSUB 9400
1490  P1=133
1500  P2=0
1510  GOSUB 9400
1520  P1=34
1530  P2=117
1540  GOSUB 9400
1550  P1=134
1560  P2=122
1570  GOSUB 9400
1580  P1=32
1590  GOSUB 8800
1600  GOTO 7000
1610  P1=E[22]
1620  P2=E[54]
1630  P3=E[54]
1640  GOSUB 8600
1650  M2=P4
1660  IF M2=1 THEN 330
1665  GOTO 7500
1670  IF D[1,Q2]=L1 OR D[2,Q2]=L1 THEN 1680
1671  IF (Q2=21 AND (D[1,20]=L1 OR D[2,20]=L1) AND D[4,20]=0) OR (Q2=22 AND (D[1,20]=L1 OR D[2,20]=L1) AND D[4,20]=2) THEN 1680
1672  IF Q2#21 AND Q2#22 THEN 1690
1673  IF 4 <= 8*((A[4,L1]/8)-INT(A[4,L1]/8)) <= 6 THEN 1680
1674  GOTO 1690
1680  R9=94
1690  FOR X=1 TO 5
1700  IF  NOT (J[2,X]=L1 AND D1 >= 2 AND Q2=17) THEN 1715
1710  R9=94
1715  NEXT X
1720  IF M1=0 THEN 1740
1730  R9=138
1740  IF D[1,Q2]#-1 THEN 1760
1750  R9=24
1760  GOTO 7000
1780  R9=98
1790  FOR X=1 TO 100
1800  IF X=35 OR D[1,X]#-1 THEN 1880
1810  IF R9#98 THEN 1840
1820  P1=99
1830  GOSUB 8000
1840  P1=X
1850  P2=-1
1860  GOSUB 8400
1870  R9=0
1880  NEXT X
1890  IF D[1,35]#-1 THEN 1910
1900  R9=141
1910  GOTO 7000
1920  IF Q2#8 THEN 1950
1930  R9=100
1940  GOTO 7000
1950  IF Q2#11 AND Q2#31 AND Q2#33 THEN 2090
1960  R9=102
1970  IF Q2#31 OR D[4,31]=0 THEN 1990
1980  R9=110
1990  IF Q2#33 THEN 2010
2000  R9=182
2010  IF Q2#11 OR M1=1 OR (D[1,8]#L1 AND D[1,8]#-1) THEN 7000
2020  R9=101
2030  P1=8
2040  P2=0
2050  GOSUB 9400
2060  D[4,8]=0
2070  L4=L4+1
2080  GOTO 7000
2090  IF Q2#17 THEN 2140
2100  IF D[1,17]#L1 AND D[1,17]#-1 THEN 7000
2110  R9=103
2120  D1=D1+1
2130  GOTO 7000
2140  IF Q2#35 THEN 2280
2150  IF D[4,35]#0 THEN 2170
2160  R9=102
2170  IF D[4,35]#3 THEN 2190
2180  R9=110
2190  IF D[1,19]#L1 AND D[1,19]#-1 THEN 7000
2200  P1=19
2210  P2=0
2220  GOSUB 9400
2230  D[4,35]=1
2240  D[2,28]=D[4,28]=0
2250  R9=168
2260  GOTO 7000
2280  R9=14
2290  GOTO 7000
2300  IF Q2=58 THEN 2460
2310  IF Q2#0 AND Q2#20 THEN 7000
2320  IF Q2=0 AND D[1,20]#L1 AND D[1,20]#-1 THEN 580
2330  R9=107
2340  IF 2*((A[4,L1]/8)-INT(A[4,L1]/8)) >= 1 THEN 2360
2350  R9=106
2360  IF D[4,20]=1 THEN 2380
2370  R9=105
2380  IF R9#107 THEN 7000
2390  D[4,20]=2*INT(2*((A[4,L1]/4)-INT(A[4,L1]/4)))
2400  Q8=21*(D[4,20]=0)+22*(D[4,20]=2)
2410  IF D[1,20]#-1 THEN 2430
2420  D[1,Q8]=-1
2430  IF Q8#22 THEN 2450
2440  R9=108
2450  GOTO 7000
2460  R9=29
2470  IF 8*((A[4,L1]/8)-INT(A[4,L1]/8)) >= 1 THEN 2490
2480  R9=144
2490  IF 8*((A[4,L1]/8)-INT(A[4,L1]/8)) <= 1 OR D[1,58]#-1 THEN 7000
2500  P1=145
2510  GOSUB 8000
2520  D[4,58]=2
2530  D[2,58]=-1
2540  GOTO 630
2550  IF D[4,6]<0 OR M1=0 THEN 7000
2560  N2=133
2570  IF L1#115 THEN 2590
2580  N2=134
2590  IF D[1,6]#L1 AND D[1,6]#-1 THEN 2610
2600  N2=135
2610  P1=N2
2620  GOSUB 8000
2630  GOTO 330
2640  M3=1
2650  GOTO 330
2660  M3=0
2670  PRINT "IF YOU WERE TO QUIT NOW, YOU WOULD SCORE"Q6"OUT OF A POSSIBLE 350."
2680  P1=E[143]
2690  P2=E[54]
2700  P3=E[54]
2710  GOSUB 8600
2720  M2=P4
2730  GOTO 1660
2760  C$=A$
2770  P1=3
2780  O0=2790
2785  GOSUB 9600
2790  Q8=P1
2800  R9=42
2801  IF N1=1-Q8 THEN 2810
2802  IF N1=0 THEN 2804
2803  R9=151
2804  GOTO 7000
2810  N1=Q8
2820  IF Q8#4 THEN 6900
2830  N1=0
2840  IF D[1,56]=92 OR (D[1,56]=-1 AND L1=92) THEN 7000
2850  IF  NOT (D[1,56]=0 AND D[1,33]=0 AND D[4,33]=0) THEN 2870
2860  D[4,33]=1
2870  Q8=2
2880  IF D[1,56]#L1 AND D[1,56]#-1 THEN 2900
2890  Q8=1
2900  IF L1#92 THEN 2920
2910  Q8=0
2920  P1=56
2930  P2=92
2940  GOSUB 9400
2950  P1=56
2960  P2=Q8
2970  GOSUB 8400
2980  GOSUB 7500
2990  R9=156
3000  M6=10000
3010  M7=3
3020  GOTO 7000
3030  IF D[1,16]#L1 AND D[1,16]#-1 THEN 3050
3040  Q2=16
3050  IF D[1,13]#L1 AND D[1,13]#-1 THEN 3070
3060  Q2=Q2*100+13
3070  IF D[1,36]#L1 AND D[1,36]#-1 THEN 3090
3080  Q2=Q2*100+36
3090  IF M1=0 OR D[1,15]#-1 THEN 3110
3100  Q2=15
3110  IF Q2>100 OR Q2=0 THEN 580
3111  IF ((D[1,2]#L1 AND D[1,2]#-1) OR D[4,2]#1) AND 2*((A[4,L1]/2)-INT(A[4,L1]/2))#1 THEN 580
3120  IF ((D[1,2]#L1 AND D[1,2]#-1) OR D[4,2]#1) AND 2*((A[4,L1]/2)-INT(A[4,L1]/2))#1 THEN 350
3130  IF Q2#16 THEN 3150
3140  R9=190
3150  IF Q2#13 THEN 3170
3160  R9=196
3170  IF Q2#36 THEN 3190
3180  R9=191
3190  IF Q2#15 OR H[2,5]=0 OR D[1,15]#-1 THEN 3210
3200  R9=194
3210  IF Q2#15 OR H[2,5]=1 OR D[1,15]#-1 OR M1=0 THEN 7000
3220  P1=E[192]
3230  P2=E[193]
3240  P3=E[54]
3250  GOSUB 8600
3260  H[2,5]=P4
3270  GOTO 7500
3290  IF Q2#23 THEN 3310
3300  R9=148
3310  IF Q2=58 AND D[4,58]=0 THEN 3360
3320  IF Q2#23 OR M1=0 THEN 7000
3330  P1=197
3340  GOSUB 8000
3350  GOTO 320
3360  R9=198
3370  IF D[1,58]#-1 THEN 3410
3380  P1=58
3390  P2=L1
3400  GOSUB 9200
3410  D[4,58]=2
3420  D[2,58]=-1
3430  GOTO 7000
3440  IF Q2#17 OR M1=0 THEN 7000
3450  P1=199
3460  GOSUB 8000
3470  GOTO 320
3480  PURGE X,B$
3490  CREATE X,B$,20
3500  IF X=0 THEN 3530
3510  PRINT "CANNOT CREATE/ASSIGN SAVE FILE."
3520  GOTO 210
3530  ASSIGN B$,3,X
3540  IF X THEN 3510
3550  MAT  PRINT #3;A
3560  MAT  PRINT #3;D
3570  MAT  PRINT #3;E
3580  MAT  PRINT #3;F
3590  MAT  PRINT #3;G
3600  MAT  PRINT #3;H
3610  MAT  PRINT #3;I
3620  MAT  PRINT #3;J
3630  PRINT #3;D1,L1,L2,L3,L4,L5,L6,L7,L8,L9,M1,M2,M3,M4,M5,M6,M7,M8,M9
3640  PRINT #3;N1,N2,N3,N4,N5,N6,Q1,Q2,Q3,Q4,Q5,Q6,Q7,Q8,R9
3650  PRINT "YOUR ADVENTURE GAME HAS BEEN SAVED."
3660  STOP 
3670  ASSIGN B$,3,X
3680  IF X=0 THEN 3710
3690  PRINT "CANNOT ASSIGN RESTORE FILE."
3700  STOP 
3710  MAT  READ #3;A
3720  MAT  READ #3;D
3730  MAT  READ #3;E
3740  MAT  READ #3;F
3750  MAT  READ #3;G
3760  MAT  READ #3;H
3770  MAT  READ #3;I
3780  MAT  READ #3;J
3790  READ #3;D1,L1,L2,L3,L4,L5,L6,L7,L8,L9,M1,M2,M3,M4,M5,M6,M7,M8,M9
3800  READ #3;N1,N2,N3,N4,N5,N6,Q1,Q2,Q3,Q4,Q5,Q6,Q7,Q8,R9
3810  GOTO 210
6900  Q8=54
6950  R9=Q8
7000  P1=R9
7010  GOSUB 8000
7500  Q2=Q7=0
7510  GOTO 220
8000  REM * RSPEAK
8001  IF P1#0 THEN 8010
8002  RETURN 
8010  P1=E[P1]
8020  GOTO 8200
8200  REM * SPEAK
8210  READ #1,R1
8220  ADVANCE #1;P1,Z9
8320  READ #1;C$
8330  IF C$[1,3]=">$<" THEN 8380
8340  IF C$="" THEN 8370
8350  PRINT C$
8360  GOTO 8320
8370  PRINT 
8380  RETURN 
8400  REM * PSPEAK
8410  READ #1,R1
8420  ADVANCE #1;D[3,P1],Z9
8440  FOR Z9=0 TO P2
8450  READ #1;C$
8460  IF C$#"" THEN 8450
8470  NEXT Z9
8475  READ #1;C$
8480  GOTO 8330
8600  REM * YESX
8610  IF P1=0 THEN 8630
8620  GOSUB 8200
8625  PRINT "=>";
8630  LINPUT C$
8640  IF C$[1,1]="Y" THEN 8700
8650  IF C$[1,1]="N" THEN 8750
8670  PRINT "PLEASE ANSWER THE QUESTION."
8680  GOTO 8630
8700  P4=1
8710  P1=P2
8720  IF P1=0 THEN 8740
8730  GOSUB 8200
8740  RETURN 
8750  P4=2
8760  P1=P3
8770  IF P1=0 THEN 8790
8780  GOSUB 8200
8790  RETURN 
8800  REM * JUGGLE
8810  P2=D[1,P1]
8820  GOSUB 9400
8830  P2=D[2,P1]
8840  P1=P1+100
8850  GOSUB 9400
8860  RETURN 
9000  REM * CARRY
9010  IF P1>100 THEN 9060
9020  IF D[1,P1]#-1 THEN 9040
9030  RETURN 
9040  D[1,P1]=-1
9050  L2=L2+1
9060  IF A[6,P2]#P1 THEN 9090
9070  A[6,P2]=D[5+(P1>100),P1-100*(P1>100)]
9080  RETURN 
9090  Z9=A[6,P2]
9100  IF D[5+(Z9>100),Z9-100*(Z9>100)]=P1 THEN 9130
9110  Z9=D[5+(Z9>100),Z9-100*(Z9>100)]
9120  GOTO 9100
9130  D[5+(Z9>100),Z9-100*(Z9>100)]=D[5+(P1>100),P1-100*(P1>100)]
9140  RETURN 
9200  REM * DROP
9210  IF P1>100 THEN 9260
9220  IF D[1,P1]#-1 THEN 9240
9230  L2=L2-1
9240  D[1,P1]=P2
9250  GOTO 9270
9260  D[2,P1-100]=P2
9270  IF P2>0 THEN 9290
9280  RETURN 
9290  D[5+(P1>100),P1-100*(P1>100)]=A[6,P2]
9295  A[6,P2]=P1
9300  RETURN 
9400  REM * MOVE
9401  Z8=P2
9410  IF P1>100 THEN 9440
9420  Z9=D[1,P1]
9430  GOTO 9450
9440  Z9=D[2,P1-100]
9450  IF Z9 <= 0 OR Z9>300 THEN 9470
9455  P2=Z9
9460  GOSUB 9000
9470  P2=Z8
9480  GOSUB 9200
9490  RETURN 
9600  REM * VOCAB
9610  GOTO 366
9999  END 
